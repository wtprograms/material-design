import { ChangeDetectionStrategy, Component, computed, effect, forwardRef, model, signal, viewChild, viewChildren, ViewEncapsulation, } from '@angular/core';
import { ButtonComponent } from '../button/button.component';
import { IconButtonComponent } from '../icon-button/icon-button.component';
import { FieldComponent } from '../field/field.component';
import { CommonModule } from '@angular/common';
import { MaterialDesignValueAccessorComponent } from '../material-design-value-accessor.component';
import { IconComponent } from '../icon/icon.component';
import { openClose } from '../../common/rxjs/open-close';
import { toSignal } from '@angular/core/rxjs-interop';
import { ListItemComponent } from '../list-item/list-item.component';
import { DialogComponent } from '../dialog/dialog.component';
import { SlotDirective } from '../../directives/slot.directive';
import { TooltipComponent } from '../tooltip/tooltip.component';
import { DateFormatPipe } from '../../pipes/date-format.pipe';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
export class DatePickerComponent extends MaterialDesignValueAccessorComponent {
    range = model(false);
    variant = model('dropdown');
    fieldVariant = model('filled');
    prefix = model();
    suffix = model();
    label = model();
    field = viewChild('field');
    dialog = viewChild('dialog');
    populated = computed(() => {
        if (this.field()?.popover()?.state() === 'closing' && !this.value()) {
            return false;
        }
        return (!!this.value() ||
            this.field()?.open() ||
            this.field()?.popover()?.state() === 'opening');
    });
    _today = new Date();
    value = model();
    selectionValue = model(this.value());
    canOkay = computed(() => {
        if (this.range() &&
            this.fromSelectedValueAsDate &&
            !this.toSelectedValueAsDate) {
            return false;
        }
        return true;
    });
    get fromValueAsDate() {
        if (this.range()) {
            return this.value()?.[0] ? new Date(this.value()[0]) : undefined;
        }
        return this.value() ? new Date(this.value()) : undefined;
    }
    set fromValueAsDate(value) {
        if (this.range()) {
            this.value.update((x) => [value?.toISOString(), x?.[1]]);
        }
        else {
            this.value.set(value?.toISOString());
        }
    }
    get toValueAsDate() {
        if (!this.range()) {
            return undefined;
        }
        return this.value()?.[1] ? new Date(this.value()[1]) : undefined;
    }
    set toValueAsDate(value) {
        if (!this.range()) {
            return;
        }
        this.value.update((x) => [x?.[0], value?.toISOString()]);
    }
    get fromSelectedValueAsDate() {
        if (this.range()) {
            return this.selectionValue()?.[0]
                ? new Date(this.selectionValue()[0])
                : undefined;
        }
        return this.selectionValue()
            ? new Date(this.selectionValue())
            : undefined;
    }
    set fromSelectedValueAsDate(value) {
        if (this.range()) {
            this.selectionValue.update((x) => [value?.toISOString(), x?.[1]]);
        }
        else {
            this.selectionValue.set(value?.toISOString());
        }
    }
    get toSelectedValueAsDate() {
        if (!this.range()) {
            return undefined;
        }
        return this.selectionValue()?.[1]
            ? new Date(this.selectionValue()[1])
            : undefined;
    }
    set toSelectedValueAsDate(value) {
        if (!this.range()) {
            return;
        }
        this.selectionValue.update((x) => [x?.[0], value?.toISOString()]);
    }
    locale = model('en');
    monthItems = viewChildren('monthItem');
    monthView = model(this._today.getMonth());
    monthViewText = computed(() => {
        const month = this.monthView();
        const date = this.fromSelectedValueAsDate ?? new Date(this._today);
        date.setMonth(month);
        const dateString = date.toLocaleDateString(this.locale(), {
            month: 'short',
        });
        return dateString;
    });
    months = computed(() => {
        const formatter = new Intl.DateTimeFormat(this.locale(), { month: 'long' });
        return Array.from({ length: 12 }, (_, value) => ({
            text: formatter.format(new Date(0, value)),
            value,
        }));
    });
    monthViewOpen = signal(false);
    monthViewState = toSignal(openClose(this.monthViewOpen, 'short4'), {
        initialValue: 'closed',
    });
    yearItems = viewChildren('yearItem');
    yearView = model(this._today.getFullYear());
    yearViewText = computed(() => {
        const year = this.yearView();
        const date = this.fromSelectedValueAsDate ?? new Date(this._today);
        date.setFullYear(year);
        const dateString = date.toLocaleDateString(this.locale(), {
            year: 'numeric',
        });
        return dateString;
    });
    get years() {
        const currentYear = new Date().getFullYear();
        const startYear = currentYear - 50;
        const endYear = currentYear + 20;
        return Array.from({ length: endYear - startYear + 1 }, (_, value) => startYear + value);
    }
    yearViewOpen = signal(false);
    yearViewState = toSignal(openClose(this.yearViewOpen, 'short4'), {
        initialValue: 'closed',
    });
    dayNames = computed(() => {
        const formatter = new Intl.DateTimeFormat(this.locale(), {
            weekday: 'narrow',
        });
        return Array.from({ length: 7 }, (_, i) => formatter.format(new Date(1970, 0, i + 4)));
    });
    days = computed(() => {
        const month = this.monthView();
        const year = this.yearView();
        const date = new Date(year, month);
        const firstDayOfMonth = new Date(date.getFullYear(), date.getMonth(), 1).getDay();
        const startDate = new Date(date.getFullYear(), date.getMonth(), 1 - firstDayOfMonth);
        const calendarDays = [];
        for (let i = 0; i < 42; i++) {
            const currentDate = new Date(startDate);
            currentDate.setDate(startDate.getDate() + i);
            const day = currentDate.getDate();
            let type = 'current';
            if (currentDate.getMonth() < date.getMonth()) {
                type = 'previous';
            }
            else if (currentDate.getMonth() > date.getMonth()) {
                type = 'next';
            }
            calendarDays.push({ day, type, date: currentDate });
        }
        return calendarDays;
    });
    fromSelection = true;
    constructor() {
        super();
        effect(() => {
            if (this.variant() === 'embedded') {
                this.value.set(this.selectionValue());
            }
        }, {
            allowSignalWrites: true,
        });
    }
    openMonthView() {
        this.yearViewOpen.set(false);
        this.monthViewOpen.set(!this.monthViewOpen());
        const selectedItem = this.monthItems().find((x) => x.selected());
        selectedItem?.hostElement.scrollIntoView({
            block: 'nearest',
        });
    }
    monthItemClick(month) {
        this.monthView.set(month);
        this.monthViewOpen.set(false);
    }
    openYearView() {
        this.monthViewOpen.set(false);
        this.yearViewOpen.set(!this.yearViewOpen());
        const selectedItem = this.yearItems().find((x) => x.variant() === 'filled');
        selectedItem?.hostElement.scrollIntoView({
            block: 'nearest',
        });
    }
    yearItemClick(year) {
        this.yearView.set(year);
        this.yearViewOpen.set(false);
    }
    todayClick() {
        this.monthView.set(this._today.getMonth());
        this.yearView.set(this._today.getFullYear());
    }
    dayClick(day) {
        if (this.fromSelection) {
            this.fromSelectedValueAsDate = day.date;
            this.toSelectedValueAsDate = undefined;
        }
        else {
            if (this.fromSelectedValueAsDate &&
                day.date < this.fromSelectedValueAsDate) {
                this.fromSelection = !this.fromSelection;
                this.dayClick(day);
                return;
            }
            this.toSelectedValueAsDate = day.date;
        }
        this.monthView.set(day.date.getMonth());
        this.yearView.set(day.date.getFullYear());
        if (this.range()) {
            this.fromSelection = !this.fromSelection;
        }
    }
    isDateEqual(dateA, dateB) {
        return (dateA?.getFullYear() === dateB?.getFullYear() &&
            dateA?.getMonth() === dateB?.getMonth() &&
            dateA?.getDate() === dateB?.getDate());
    }
    isToday(date) {
        return (this._today.getFullYear() === date.getFullYear() &&
            this._today.getMonth() === date.getMonth() &&
            this._today.getDate() === date.getDate());
    }
    isDaySelected(date) {
        return (this.isDateEqual(this.fromSelectedValueAsDate, date) ||
            this.isDateEqual(this.toSelectedValueAsDate, date));
    }
    isInRange(date) {
        if (!this.fromSelectedValueAsDate || !this.toSelectedValueAsDate) {
            return false;
        }
        return (date >= this.fromSelectedValueAsDate && date <= this.toSelectedValueAsDate);
    }
    clearClick() {
        this.fromSelection = true;
        this.value.set(undefined);
        this.selectionValue.set(undefined);
    }
    okayClick() {
        this.fromSelection = true;
        this.value.set(this.selectionValue());
        this.monthView.set(this.fromSelectedValueAsDate?.getMonth() ?? this._today.getMonth());
        this.yearView.set(this.fromSelectedValueAsDate?.getFullYear() ?? this._today.getFullYear());
        if (this.variant() === 'dropdown') {
            this.field()?.open.set(false);
        }
        if (this.variant() === 'dialog') {
            this.dialog()?.open.set(false);
        }
        this.monthViewOpen.set(false);
        this.yearViewOpen.set(false);
    }
    cancelClick() {
        this.fromSelection = true;
        this.selectionValue.set(this.value());
        this.monthView.set(this.fromSelectedValueAsDate?.getMonth() ?? this._today.getMonth());
        this.yearView.set(this.fromSelectedValueAsDate?.getFullYear() ?? this._today.getFullYear());
        if (this.variant() === 'dropdown') {
            this.field()?.open.set(false);
        }
        if (this.variant() === 'dialog') {
            this.dialog()?.open.set(false);
        }
        this.monthViewOpen.set(false);
        this.yearViewOpen.set(false);
    }
    bodyClick() {
        if (this.variant() !== 'dialog') {
            return;
        }
        this.dialog()?.open.set(true);
    }
    popoverStateChange(state) {
        if (state === 'closed') {
            this.cancelClick();
        }
    }
    static ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.9", ngImport: i0, type: DatePickerComponent, deps: [], target: i0.ɵɵFactoryTarget.Component });
    static ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "18.2.9", type: DatePickerComponent, isStandalone: true, selector: "md-date-picker", inputs: { range: { classPropertyName: "range", publicName: "range", isSignal: true, isRequired: false, transformFunction: null }, variant: { classPropertyName: "variant", publicName: "variant", isSignal: true, isRequired: false, transformFunction: null }, fieldVariant: { classPropertyName: "fieldVariant", publicName: "fieldVariant", isSignal: true, isRequired: false, transformFunction: null }, prefix: { classPropertyName: "prefix", publicName: "prefix", isSignal: true, isRequired: false, transformFunction: null }, suffix: { classPropertyName: "suffix", publicName: "suffix", isSignal: true, isRequired: false, transformFunction: null }, label: { classPropertyName: "label", publicName: "label", isSignal: true, isRequired: false, transformFunction: null }, value: { classPropertyName: "value", publicName: "value", isSignal: true, isRequired: false, transformFunction: null }, selectionValue: { classPropertyName: "selectionValue", publicName: "selectionValue", isSignal: true, isRequired: false, transformFunction: null }, locale: { classPropertyName: "locale", publicName: "locale", isSignal: true, isRequired: false, transformFunction: null }, monthView: { classPropertyName: "monthView", publicName: "monthView", isSignal: true, isRequired: false, transformFunction: null }, yearView: { classPropertyName: "yearView", publicName: "yearView", isSignal: true, isRequired: false, transformFunction: null } }, outputs: { range: "rangeChange", variant: "variantChange", fieldVariant: "fieldVariantChange", prefix: "prefixChange", suffix: "suffixChange", label: "labelChange", value: "valueChange", selectionValue: "selectionValueChange", locale: "localeChange", monthView: "monthViewChange", yearView: "yearViewChange" }, providers: [
            {
                provide: NG_VALUE_ACCESSOR,
                multi: true,
                useExisting: forwardRef(() => DatePickerComponent),
            },
        ], viewQueries: [{ propertyName: "field", first: true, predicate: ["field"], descendants: true, isSignal: true }, { propertyName: "dialog", first: true, predicate: ["dialog"], descendants: true, isSignal: true }, { propertyName: "monthItems", predicate: ["monthItem"], descendants: true, isSignal: true }, { propertyName: "yearItems", predicate: ["yearItem"], descendants: true, isSignal: true }], usesInheritance: true, ngImport: i0, template: "<ng-template #actions>\n  <md-button [attr.slot]=\"variant() === 'dialog' ? 'action' : null\" variant=\"text\" class=\"clear\" (click)=\"clearClick()\"\n    i18n>Clear</md-button>\n  @if (variant() !== 'embedded') {\n  <md-button [attr.slot]=\"variant() === 'dialog' ? 'action' : null\" variant=\"text\" (click)=\"okayClick()\"\n    [disabled]=\"!canOkay()\" i18n>Okay</md-button>\n  <md-button [attr.slot]=\"variant() === 'dialog' ? 'action' : null\" variant=\"text\" (click)=\"cancelClick()\"\n    i18n>Cancel</md-button>\n  }\n</ng-template>\n\n<ng-template #contents>\n  <div class=\"container\">\n    <div class=\"header\">\n      <div class=\"months\">\n        <md-button variant=\"plain\" class=\"navigate\" (click)=\"monthView.set(monthView() - 1)\">\n          <md-icon>chevron_left</md-icon>\n        </md-button>\n        <md-button #monthViewButton variant=\"plain\" (click)=\"openMonthView()\">\n          {{ monthViewText() }}\n          <md-icon class=\"month-icon\" slot=\"trailing\">arrow_drop_down</md-icon>\n        </md-button>\n        <md-button variant=\"plain\" class=\"navigate\" (click)=\"monthView.set(monthView() + 1)\">\n          <md-icon>chevron_right</md-icon>\n        </md-button>\n      </div>\n      @if (variant() === 'dropdown') {\n      <md-icon-button #today (click)=\"todayClick()\">today</md-icon-button>\n      <md-tooltip [target]=\"today\" i18n>Today</md-tooltip>\n      } @else {\n      <md-button variant=\"text\" (click)=\"todayClick()\" i18n>Today</md-button>\n      }\n      <div class=\"years\">\n        <md-button variant=\"plain\" class=\"navigate\" (click)=\"yearView.set(yearView() - 1)\">\n          <md-icon>chevron_left</md-icon>\n        </md-button>\n        <md-button variant=\"plain\" (click)=\"openYearView()\">\n          {{ yearViewText() }}\n          <md-icon slot=\"trailing\">arrow_drop_down</md-icon>\n        </md-button>\n        <md-button variant=\"plain\" class=\"navigate\" (click)=\"yearView.set(yearView() + 1)\">\n          <md-icon>chevron_right</md-icon>\n        </md-button>\n      </div>\n    </div>\n    <div class=\"body\">\n      <div class=\"view\" [ngClass]=\"monthViewState()\">\n        @for (month of months(); track $index) {\n        <md-list-item #monthItem [selected]=\"monthView() === month.value\" (click)=\"monthItemClick(month.value)\"\n          type=\"button\">\n          {{ month.text }}\n        </md-list-item>\n        }\n      </div>\n      <div class=\"view year-view\" [ngClass]=\"yearViewState()\">\n        @for (year of years; track $index) {\n        <md-button #yearItem [variant]=\"yearView() === year ? 'filled' : 'text'\" (click)=\"yearItemClick(year)\">\n          {{ year }}\n        </md-button>\n        }\n      </div>\n      <div class=\"calendar\">\n        <div class=\"days day-names\">\n          @for (dayName of dayNames(); track $index) {\n          <div class=\"day-container\">\n            <div class=\"day-name\">{{ dayName }}</div>\n          </div>\n          }\n        </div>\n        <div class=\"days\">\n          @for (day of days(); track $index) {\n          <div class=\"day-container\">\n            @if (isInRange(day.date)) {\n            <div class=\"in-range-indicator\" [class.first]=\"isDateEqual(fromSelectedValueAsDate, day.date)\"\n              [class.last]=\"isDateEqual(toSelectedValueAsDate, day.date)\" [class.not-current]=\"day.type !== 'current'\">\n            </div>\n            }\n            <md-icon-button [custom]=\"true\" [selected]=\"isDaySelected(day.date)\"\n              [variant]=\"isDaySelected(day.date) ? 'filled' : 'standard'\" [class.not-current]=\"day.type !== 'current'\"\n              [class.today]=\"isToday(day.date)\" (click)=\"dayClick(day)\" [class.in-range]=\"isInRange(day.date)\">{{\n              day.day\n              }}</md-icon-button>\n          </div>\n          }\n        </div>\n      </div>\n    </div>\n    @if (variant() !== 'dialog') {\n    <div class=\"actions\">\n      <ng-container *ngTemplateOutlet=\"actions\" />\n    </div>\n    }\n  </div>\n</ng-template>\n\n@if (variant() === 'embedded') {\n<ng-container *ngTemplateOutlet=\"contents\" />\n} @else {\n<md-field #field [variant]=\"fieldVariant()\" [populated]=\"!!populated()\" [errorText]=\"errorText()\" [label]=\"label()\"\n  [disabled]=\"disabled()\" (bodyClick)=\"bodyClick()\" (popoverStateChange)=\"popoverStateChange($event)\">\n  <slot name=\"leading\" slot=\"leading\"></slot>\n  <slot name=\"prefix\" slot=\"prefix\"></slot>\n  <slot name=\"suffix\" slot=\"suffix\"></slot>\n  <slot name=\"supporting-text\" slot=\"supporting-text\"></slot>\n  <slot name=\"counter\" slot=\"counter\"></slot>\n  <span class=\"selected-value\">\n    @if (!fromValueAsDate) {\n    <span i18n>Select a date...</span>\n    } @else {\n    <span>{{ fromValueAsDate | dateFormat: this.locale(): 'dd MMM yyyy' }}</span>\n    @if (range()) {\n    <span>-</span>\n    <span>{{ toValueAsDate | dateFormat: this.locale(): 'dd MMM yyyy' }}</span>\n    }\n    }\n  </span>\n  <md-icon slot=\"trailing\">calendar_month</md-icon>\n  @if (variant() === 'dropdown') {\n  <div class=\"popover\" slot=\"popover\">\n    <ng-container *ngTemplateOutlet=\"contents\" />\n  </div>\n  }\n</md-field>\n@if (variant() === 'dialog') {\n<md-dialog #dialog (stateChange)=\"popoverStateChange($event)\">\n  <md-icon slot=\"icon\">calendar_month</md-icon>\n  <span class=\"selected-value\" slot=\"headline\">\n    @if (!fromSelectedValueAsDate) {\n    <span i18n>Select a date...</span>\n    } @else {\n    <span>{{ fromSelectedValueAsDate | dateFormat: this.locale(): 'dd MMM yyyy' }}</span>\n    @if (range()) {\n    <span>-</span>\n    <span>{{ toSelectedValueAsDate | dateFormat: this.locale(): 'dd MMM yyyy' }}</span>\n    }\n    }\n  </span>\n  <slot name=\"supporting-text\" slot=\"supporting-text\"></slot>\n  <ng-container *ngTemplateOutlet=\"contents\" />\n  <ng-container *ngTemplateOutlet=\"actions\" />\n</md-dialog>\n}\n}", styles: [":host md-field::part(body){cursor:pointer}:host .popover{display:inline-flex}:host .container{display:inline-flex;flex-direction:column;isolation:isolate;flex-grow:1;background-color:var(--md-sys-color-surface-container);border-radius:var(--md-sys-shape-extra-small);padding-top:20px;padding-bottom:12px;padding-inline:12px}:host .container .header{display:inline-flex;justify-content:space-between;margin-bottom:30px}:host .container .months,:host .container .years{display:inline-flex}:host .container .navigate{width:40px;height:40px}:host .container md-button[variant=plain]:not(.navigate){padding-inline-start:12px;padding-inline-end:4px}:host .container .body{position:relative;flex-grow:1;flex-direction:column;display:inline-flex}:host .container .view{display:inline-flex;flex-direction:column;visibility:hidden;position:absolute;inset:0;background-color:var(--md-sys-color-surface-container);height:0px;opacity:0;overflow-y:auto;z-index:1;transition-property:height,opacity,visibility;transition-duration:var(--md-sys-motion-duration-short-4);transition-timing-function:var(--md-sys-motion-easing-standard)}:host .container .view:before{content:\"\";position:fixed;inset:0 0 auto;border-top:1px solid var(--md-sys-color-outline)}:host .container .view:not(.closed){height:auto;opacity:1;visibility:visible}:host .container .view.year-view{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;padding-top:8px;padding-bottom:8px;padding-inline:16px}:host .container .calendar{display:inline-flex;flex-direction:column}:host .container .calendar .day-names{margin-bottom:16px}:host .container .calendar .days{display:grid;grid-template-columns:repeat(7,1fr)}:host .container .calendar .days .day-container{position:relative;display:inline-flex;justify-content:center;align-items:center;text-align:center;height:40px}:host .container .calendar .days .day-name{display:inline-flex;justify-content:center;align-items:center;text-align:center;font-size:var(--md-sys-typescale-label-large-size);font-weight:var(--md-sys-typescale-label-large-weight);font-family:var(--md-sys-typescale-label-large-font);height:40px;width:40px;justify-self:center;align-self:center}:host .container .calendar .days .today{border:1px solid var(--md-sys-color-primary)}:host .container .calendar .days .in-range-indicator{position:absolute;height:24px;background-color:var(--md-sys-color-primary);inset-inline:0;z-index:-1}:host .container .calendar .days .in-range-indicator.first{inset-inline-start:50%}:host .container .calendar .days .in-range-indicator.last{inset-inline-end:50%}:host .container .calendar .days .in-range-indicator.not-current{background:color-mix(in oklab,var(--md-sys-color-primary),var(--md-sys-color-surface) 50%)}:host .container md-icon-button{justify-self:center;align-self:center}:host .container md-icon-button.in-range{color:var(--md-sys-color-primary-on)}:host .container md-icon-button.not-current{color:color-mix(in oklab,currentColor,var(--md-sys-color-surface) 50%)}:host .container md-icon-button.not-current[variant=filled]{color:var(--md-sys-color-primary-on);background:color-mix(in oklab,var(--md-sys-color-primary),var(--md-sys-color-surface) 50%)}:host .container md-icon-button.in-range.not-current:not([variant=filled]){color:var(--md-sys-color-primary-on)}:host .actions{display:inline-flex;justify-content:flex-end;gap:8px;flex-grow:1;margin-top:8px}:host .clear{margin-inline-end:auto}:host .selected-value{display:inline-flex;gap:8px}\n"], dependencies: [{ kind: "component", type: ButtonComponent, selector: "md-button", inputs: ["variant", "disabled", "type", "href", "anchorTarget", "name", "value", "progressIndeterminate", "progressValue", "progressMax"], outputs: ["variantChange", "disabledChange", "typeChange", "hrefChange", "anchorTargetChange", "nameChange", "valueChange", "progressIndeterminateChange", "progressValueChange", "progressMaxChange"] }, { kind: "component", type: IconButtonComponent, selector: "md-icon-button", inputs: ["disabled", "type", "href", "anchorTarget", "name", "value", "progressIndeterminate", "progressValue", "progressMax", "variant", "selected", "custom", "badgeDot", "badgeNumber"], outputs: ["disabledChange", "typeChange", "hrefChange", "anchorTargetChange", "nameChange", "valueChange", "progressIndeterminateChange", "progressValueChange", "progressMaxChange", "variantChange", "selectedChange", "customChange", "badgeDotChange", "badgeNumberChange"] }, { kind: "component", type: FieldComponent, selector: "md-field", inputs: ["value", "variant", "label", "populated", "open", "popoverTrigger", "maxPopoverHeight"], outputs: ["valueChange", "variantChange", "labelChange", "populatedChange", "contentClick", "bodyClick", "openChange", "popoverTriggerChange", "maxPopoverHeightChange", "popoverStateChange"] }, { kind: "ngmodule", type: CommonModule }, { kind: "directive", type: i1.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i1.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "component", type: IconComponent, selector: "md-icon", inputs: ["filled", "size", "badgeDot", "badgeNumber", "slot"], outputs: ["filledChange", "sizeChange", "badgeDotChange", "badgeNumberChange", "slotChange"] }, { kind: "component", type: ListItemComponent, selector: "md-list-item", inputs: ["dragging", "top", "large", "selected", "split", "disabled", "type", "href", "anchorTarget", "name", "value", "progressIndeterminate", "progressValue", "progressMax", "progressBuffer"], outputs: ["draggingChange", "topChange", "largeChange", "selectedChange", "splitChange", "disabledChange", "typeChange", "hrefChange", "anchorTargetChange", "nameChange", "valueChange", "progressIndeterminateChange", "progressValueChange", "progressMaxChange", "progressBufferChange"] }, { kind: "component", type: DialogComponent, selector: "md-dialog", inputs: ["returnValue", "open"], outputs: ["returnValueChange", "openChange", "cancel", "stateChange"] }, { kind: "directive", type: SlotDirective, selector: "slot", inputs: ["name", "slot"] }, { kind: "component", type: TooltipComponent, selector: "md-tooltip", inputs: ["variant", "placement", "trigger", "offset", "manualClose", "modal"], outputs: ["variantChange", "placementChange", "triggerChange", "offsetChange", "manualCloseChange", "modalChange"] }, { kind: "pipe", type: DateFormatPipe, name: "dateFormat" }], changeDetection: i0.ChangeDetectionStrategy.OnPush, encapsulation: i0.ViewEncapsulation.ShadowDom });
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.9", ngImport: i0, type: DatePickerComponent, decorators: [{
            type: Component,
            args: [{ selector: 'md-date-picker', standalone: true, changeDetection: ChangeDetectionStrategy.OnPush, encapsulation: ViewEncapsulation.ShadowDom, imports: [
                        ButtonComponent,
                        IconButtonComponent,
                        FieldComponent,
                        CommonModule,
                        IconComponent,
                        FieldComponent,
                        ListItemComponent,
                        DialogComponent,
                        SlotDirective,
                        TooltipComponent,
                        DateFormatPipe,
                    ], hostDirectives: [], host: {}, providers: [
                        {
                            provide: NG_VALUE_ACCESSOR,
                            multi: true,
                            useExisting: forwardRef(() => DatePickerComponent),
                        },
                    ], template: "<ng-template #actions>\n  <md-button [attr.slot]=\"variant() === 'dialog' ? 'action' : null\" variant=\"text\" class=\"clear\" (click)=\"clearClick()\"\n    i18n>Clear</md-button>\n  @if (variant() !== 'embedded') {\n  <md-button [attr.slot]=\"variant() === 'dialog' ? 'action' : null\" variant=\"text\" (click)=\"okayClick()\"\n    [disabled]=\"!canOkay()\" i18n>Okay</md-button>\n  <md-button [attr.slot]=\"variant() === 'dialog' ? 'action' : null\" variant=\"text\" (click)=\"cancelClick()\"\n    i18n>Cancel</md-button>\n  }\n</ng-template>\n\n<ng-template #contents>\n  <div class=\"container\">\n    <div class=\"header\">\n      <div class=\"months\">\n        <md-button variant=\"plain\" class=\"navigate\" (click)=\"monthView.set(monthView() - 1)\">\n          <md-icon>chevron_left</md-icon>\n        </md-button>\n        <md-button #monthViewButton variant=\"plain\" (click)=\"openMonthView()\">\n          {{ monthViewText() }}\n          <md-icon class=\"month-icon\" slot=\"trailing\">arrow_drop_down</md-icon>\n        </md-button>\n        <md-button variant=\"plain\" class=\"navigate\" (click)=\"monthView.set(monthView() + 1)\">\n          <md-icon>chevron_right</md-icon>\n        </md-button>\n      </div>\n      @if (variant() === 'dropdown') {\n      <md-icon-button #today (click)=\"todayClick()\">today</md-icon-button>\n      <md-tooltip [target]=\"today\" i18n>Today</md-tooltip>\n      } @else {\n      <md-button variant=\"text\" (click)=\"todayClick()\" i18n>Today</md-button>\n      }\n      <div class=\"years\">\n        <md-button variant=\"plain\" class=\"navigate\" (click)=\"yearView.set(yearView() - 1)\">\n          <md-icon>chevron_left</md-icon>\n        </md-button>\n        <md-button variant=\"plain\" (click)=\"openYearView()\">\n          {{ yearViewText() }}\n          <md-icon slot=\"trailing\">arrow_drop_down</md-icon>\n        </md-button>\n        <md-button variant=\"plain\" class=\"navigate\" (click)=\"yearView.set(yearView() + 1)\">\n          <md-icon>chevron_right</md-icon>\n        </md-button>\n      </div>\n    </div>\n    <div class=\"body\">\n      <div class=\"view\" [ngClass]=\"monthViewState()\">\n        @for (month of months(); track $index) {\n        <md-list-item #monthItem [selected]=\"monthView() === month.value\" (click)=\"monthItemClick(month.value)\"\n          type=\"button\">\n          {{ month.text }}\n        </md-list-item>\n        }\n      </div>\n      <div class=\"view year-view\" [ngClass]=\"yearViewState()\">\n        @for (year of years; track $index) {\n        <md-button #yearItem [variant]=\"yearView() === year ? 'filled' : 'text'\" (click)=\"yearItemClick(year)\">\n          {{ year }}\n        </md-button>\n        }\n      </div>\n      <div class=\"calendar\">\n        <div class=\"days day-names\">\n          @for (dayName of dayNames(); track $index) {\n          <div class=\"day-container\">\n            <div class=\"day-name\">{{ dayName }}</div>\n          </div>\n          }\n        </div>\n        <div class=\"days\">\n          @for (day of days(); track $index) {\n          <div class=\"day-container\">\n            @if (isInRange(day.date)) {\n            <div class=\"in-range-indicator\" [class.first]=\"isDateEqual(fromSelectedValueAsDate, day.date)\"\n              [class.last]=\"isDateEqual(toSelectedValueAsDate, day.date)\" [class.not-current]=\"day.type !== 'current'\">\n            </div>\n            }\n            <md-icon-button [custom]=\"true\" [selected]=\"isDaySelected(day.date)\"\n              [variant]=\"isDaySelected(day.date) ? 'filled' : 'standard'\" [class.not-current]=\"day.type !== 'current'\"\n              [class.today]=\"isToday(day.date)\" (click)=\"dayClick(day)\" [class.in-range]=\"isInRange(day.date)\">{{\n              day.day\n              }}</md-icon-button>\n          </div>\n          }\n        </div>\n      </div>\n    </div>\n    @if (variant() !== 'dialog') {\n    <div class=\"actions\">\n      <ng-container *ngTemplateOutlet=\"actions\" />\n    </div>\n    }\n  </div>\n</ng-template>\n\n@if (variant() === 'embedded') {\n<ng-container *ngTemplateOutlet=\"contents\" />\n} @else {\n<md-field #field [variant]=\"fieldVariant()\" [populated]=\"!!populated()\" [errorText]=\"errorText()\" [label]=\"label()\"\n  [disabled]=\"disabled()\" (bodyClick)=\"bodyClick()\" (popoverStateChange)=\"popoverStateChange($event)\">\n  <slot name=\"leading\" slot=\"leading\"></slot>\n  <slot name=\"prefix\" slot=\"prefix\"></slot>\n  <slot name=\"suffix\" slot=\"suffix\"></slot>\n  <slot name=\"supporting-text\" slot=\"supporting-text\"></slot>\n  <slot name=\"counter\" slot=\"counter\"></slot>\n  <span class=\"selected-value\">\n    @if (!fromValueAsDate) {\n    <span i18n>Select a date...</span>\n    } @else {\n    <span>{{ fromValueAsDate | dateFormat: this.locale(): 'dd MMM yyyy' }}</span>\n    @if (range()) {\n    <span>-</span>\n    <span>{{ toValueAsDate | dateFormat: this.locale(): 'dd MMM yyyy' }}</span>\n    }\n    }\n  </span>\n  <md-icon slot=\"trailing\">calendar_month</md-icon>\n  @if (variant() === 'dropdown') {\n  <div class=\"popover\" slot=\"popover\">\n    <ng-container *ngTemplateOutlet=\"contents\" />\n  </div>\n  }\n</md-field>\n@if (variant() === 'dialog') {\n<md-dialog #dialog (stateChange)=\"popoverStateChange($event)\">\n  <md-icon slot=\"icon\">calendar_month</md-icon>\n  <span class=\"selected-value\" slot=\"headline\">\n    @if (!fromSelectedValueAsDate) {\n    <span i18n>Select a date...</span>\n    } @else {\n    <span>{{ fromSelectedValueAsDate | dateFormat: this.locale(): 'dd MMM yyyy' }}</span>\n    @if (range()) {\n    <span>-</span>\n    <span>{{ toSelectedValueAsDate | dateFormat: this.locale(): 'dd MMM yyyy' }}</span>\n    }\n    }\n  </span>\n  <slot name=\"supporting-text\" slot=\"supporting-text\"></slot>\n  <ng-container *ngTemplateOutlet=\"contents\" />\n  <ng-container *ngTemplateOutlet=\"actions\" />\n</md-dialog>\n}\n}", styles: [":host md-field::part(body){cursor:pointer}:host .popover{display:inline-flex}:host .container{display:inline-flex;flex-direction:column;isolation:isolate;flex-grow:1;background-color:var(--md-sys-color-surface-container);border-radius:var(--md-sys-shape-extra-small);padding-top:20px;padding-bottom:12px;padding-inline:12px}:host .container .header{display:inline-flex;justify-content:space-between;margin-bottom:30px}:host .container .months,:host .container .years{display:inline-flex}:host .container .navigate{width:40px;height:40px}:host .container md-button[variant=plain]:not(.navigate){padding-inline-start:12px;padding-inline-end:4px}:host .container .body{position:relative;flex-grow:1;flex-direction:column;display:inline-flex}:host .container .view{display:inline-flex;flex-direction:column;visibility:hidden;position:absolute;inset:0;background-color:var(--md-sys-color-surface-container);height:0px;opacity:0;overflow-y:auto;z-index:1;transition-property:height,opacity,visibility;transition-duration:var(--md-sys-motion-duration-short-4);transition-timing-function:var(--md-sys-motion-easing-standard)}:host .container .view:before{content:\"\";position:fixed;inset:0 0 auto;border-top:1px solid var(--md-sys-color-outline)}:host .container .view:not(.closed){height:auto;opacity:1;visibility:visible}:host .container .view.year-view{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;padding-top:8px;padding-bottom:8px;padding-inline:16px}:host .container .calendar{display:inline-flex;flex-direction:column}:host .container .calendar .day-names{margin-bottom:16px}:host .container .calendar .days{display:grid;grid-template-columns:repeat(7,1fr)}:host .container .calendar .days .day-container{position:relative;display:inline-flex;justify-content:center;align-items:center;text-align:center;height:40px}:host .container .calendar .days .day-name{display:inline-flex;justify-content:center;align-items:center;text-align:center;font-size:var(--md-sys-typescale-label-large-size);font-weight:var(--md-sys-typescale-label-large-weight);font-family:var(--md-sys-typescale-label-large-font);height:40px;width:40px;justify-self:center;align-self:center}:host .container .calendar .days .today{border:1px solid var(--md-sys-color-primary)}:host .container .calendar .days .in-range-indicator{position:absolute;height:24px;background-color:var(--md-sys-color-primary);inset-inline:0;z-index:-1}:host .container .calendar .days .in-range-indicator.first{inset-inline-start:50%}:host .container .calendar .days .in-range-indicator.last{inset-inline-end:50%}:host .container .calendar .days .in-range-indicator.not-current{background:color-mix(in oklab,var(--md-sys-color-primary),var(--md-sys-color-surface) 50%)}:host .container md-icon-button{justify-self:center;align-self:center}:host .container md-icon-button.in-range{color:var(--md-sys-color-primary-on)}:host .container md-icon-button.not-current{color:color-mix(in oklab,currentColor,var(--md-sys-color-surface) 50%)}:host .container md-icon-button.not-current[variant=filled]{color:var(--md-sys-color-primary-on);background:color-mix(in oklab,var(--md-sys-color-primary),var(--md-sys-color-surface) 50%)}:host .container md-icon-button.in-range.not-current:not([variant=filled]){color:var(--md-sys-color-primary-on)}:host .actions{display:inline-flex;justify-content:flex-end;gap:8px;flex-grow:1;margin-top:8px}:host .clear{margin-inline-end:auto}:host .selected-value{display:inline-flex;gap:8px}\n"] }]
        }], ctorParameters: () => [] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0ZS1waWNrZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvd3Rwcm9ncmFtcy9tYXRlcmlhbC1kZXNpZ24vc3JjL2xpYi9jb21wb25lbnRzL2RhdGUtcGlja2VyL2RhdGUtcGlja2VyLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL3d0cHJvZ3JhbXMvbWF0ZXJpYWwtZGVzaWduL3NyYy9saWIvY29tcG9uZW50cy9kYXRlLXBpY2tlci9kYXRlLXBpY2tlci5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQ0wsdUJBQXVCLEVBQ3ZCLFNBQVMsRUFDVCxRQUFRLEVBQ1IsTUFBTSxFQUNOLFVBQVUsRUFDVixLQUFLLEVBQ0wsTUFBTSxFQUNOLFNBQVMsRUFDVCxZQUFZLEVBQ1osaUJBQWlCLEdBQ2xCLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUM3RCxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQztBQUMzRSxPQUFPLEVBQUUsY0FBYyxFQUFnQixNQUFNLDBCQUEwQixDQUFDO0FBQ3hFLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUMvQyxPQUFPLEVBQUUsb0NBQW9DLEVBQUUsTUFBTSw2Q0FBNkMsQ0FBQztBQUNuRyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDdkQsT0FBTyxFQUFFLFNBQVMsRUFBa0IsTUFBTSw4QkFBOEIsQ0FBQztBQUN6RSxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDdEQsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sa0NBQWtDLENBQUM7QUFDckUsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLDRCQUE0QixD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Z0JBQ25CLGNBQWMsc1ZBQ2QsWUFBWSxvU0FDWixhQUFhLGlOQUViLGlCQUFpQiwwaEJBQ2pCLGVBQWUsOEpBQ2YsYUFBYSwyRUFDYixnQkFBZ0IscVBBQ2hCLGNBQWM7OzJGQVlMLG1CQUFtQjtrQkE5Qi9CLFNBQVM7K0JBQ0UsZ0JBQWdCLGNBR2QsSUFBSSxtQkFDQyx1QkFBdUIsQ0FBQyxNQUFNLGlCQUNoQyxpQkFBaUIsQ0FBQyxTQUFTLFdBQ2pDO3dCQUNQLGVBQWU7d0JBQ2YsbUJBQW1CO3dCQUNuQixjQUFjO3dCQUNkLFlBQVk7d0JBQ1osYUFBYTt3QkFDYixjQUFjO3dCQUNkLGlCQUFpQjt3QkFDakIsZUFBZTt3QkFDZixhQUFhO3dCQUNiLGdCQUFnQjt3QkFDaEIsY0FBYztxQkFDZixrQkFDZSxFQUFFLFFBQ1osRUFBRSxhQUNHO3dCQUNUOzRCQUNFLE9BQU8sRUFBRSxpQkFBaUI7NEJBQzFCLEtBQUssRUFBRSxJQUFJOzRCQUNYLFdBQVcsRUFBRSxVQUFVLENBQUMsR0FBRyxFQUFFLG9CQUFvQixDQUFDO3lCQUNuRDtxQkFDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxuICBDb21wb25lbnQsXG4gIGNvbXB1dGVkLFxuICBlZmZlY3QsXG4gIGZvcndhcmRSZWYsXG4gIG1vZGVsLFxuICBzaWduYWwsXG4gIHZpZXdDaGlsZCxcbiAgdmlld0NoaWxkcmVuLFxuICBWaWV3RW5jYXBzdWxhdGlvbixcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBCdXR0b25Db21wb25lbnQgfSBmcm9tICcuLi9idXR0b24vYnV0dG9uLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBJY29uQnV0dG9uQ29tcG9uZW50IH0gZnJvbSAnLi4vaWNvbi1idXR0b24vaWNvbi1idXR0b24uY29tcG9uZW50JztcbmltcG9ydCB7IEZpZWxkQ29tcG9uZW50LCBGaWVsZFZhcmlhbnQgfSBmcm9tICcuLi9maWVsZC9maWVsZC5jb21wb25lbnQnO1xuaW1wb3J0IHsgQ29tbW9uTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcbmltcG9ydCB7IE1hdGVyaWFsRGVzaWduVmFsdWVBY2Nlc3NvckNvbXBvbmVudCB9IGZyb20gJy4uL21hdGVyaWFsLWRlc2lnbi12YWx1ZS1hY2Nlc3Nvci5jb21wb25lbnQnO1xuaW1wb3J0IHsgSWNvbkNvbXBvbmVudCB9IGZyb20gJy4uL2ljb24vaWNvbi5jb21wb25lbnQnO1xuaW1wb3J0IHsgb3BlbkNsb3NlLCBPcGVuQ2xvc2VTdGF0ZSB9IGZyb20gJy4uLy4uL2NvbW1vbi9yeGpzL29wZW4tY2xvc2UnO1xuaW1wb3J0IHsgdG9TaWduYWwgfSBmcm9tICdAYW5ndWxhci9jb3JlL3J4anMtaW50ZXJvcCc7XG5pbXBvcnQgeyBMaXN0SXRlbUNvbXBvbmVudCB9IGZyb20gJy4uL2xpc3QtaXRlbS9saXN0LWl0ZW0uY29tcG9uZW50JztcbmltcG9ydCB7IERpYWxvZ0NvbXBvbmVudCB9IGZyb20gJy4uL2RpYWxvZy9kaWFsb2cuY29tcG9uZW50JztcbmltcG9ydCB7IFNsb3REaXJlY3RpdmUgfSBmcm9tICcuLi8uLi9kaXJlY3RpdmVzL3Nsb3QuZGlyZWN0aXZlJztcbmltcG9ydCB7IFRvb2x0aXBDb21wb25lbnQgfSBmcm9tICcuLi90b29sdGlwL3Rvb2x0aXAuY29tcG9uZW50JztcbmltcG9ydCB7IERhdGVGb3JtYXRQaXBlIH0gZnJvbSAnLi4vLi4vcGlwZXMvZGF0ZS1mb3JtYXQucGlwZSc7XG5pbXBvcnQgeyBOR19WQUxVRV9BQ0NFU1NPUiB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcblxuZXhwb3J0IHR5cGUgRGF0ZVBpY2tlclZhcmlhbnQgPSAnZW1iZWRkZWQnIHwgJ2Ryb3Bkb3duJyB8ICdkaWFsb2cnO1xuXG5pbnRlcmZhY2UgRGF5IHtcbiAgZGF5OiBudW1iZXI7XG4gIHR5cGU6IHN0cmluZztcbiAgZGF0ZTogRGF0ZTtcbn1cblxudHlwZSBWYWx1ZVR5cGUgPSBbc3RyaW5nIHwgdW5kZWZpbmVkLCBzdHJpbmcgfCB1bmRlZmluZWRdIHwgc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdtZC1kYXRlLXBpY2tlcicsXG4gIHRlbXBsYXRlVXJsOiAnLi9kYXRlLXBpY2tlci5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsOiAnLi9kYXRlLXBpY2tlci5jb21wb25lbnQuc2NzcycsXG4gIHN0YW5kYWxvbmU6IHRydWUsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxuICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5TaGFkb3dEb20sXG4gIGltcG9ydHM6IFtcbiAgICBCdXR0b25Db21wb25lbnQsXG4gICAgSWNvbkJ1dHRvbkNvbXBvbmVudCxcbiAgICBGaWVsZENvbXBvbmVudCxcbiAgICBDb21tb25Nb2R1bGUsXG4gICAgSWNvbkNvbXBvbmVudCxcbiAgICBGaWVsZENvbXBvbmVudCxcbiAgICBMaXN0SXRlbUNvbXBvbmVudCxcbiAgICBEaWFsb2dDb21wb25lbnQsXG4gICAgU2xvdERpcmVjdGl2ZSxcbiAgICBUb29sdGlwQ29tcG9uZW50LFxuICAgIERhdGVGb3JtYXRQaXBlLFxuICBdLFxuICBob3N0RGlyZWN0aXZlczogW10sXG4gIGhvc3Q6IHt9LFxuICBwcm92aWRlcnM6IFtcbiAgICB7XG4gICAgICBwcm92aWRlOiBOR19WQUxVRV9BQ0NFU1NPUixcbiAgICAgIG11bHRpOiB0cnVlLFxuICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gRGF0ZVBpY2tlckNvbXBvbmVudCksXG4gICAgfSxcbiAgXSxcbn0pXG5leHBvcnQgY2xhc3MgRGF0ZVBpY2tlckNvbXBvbmVudCBleHRlbmRzIE1hdGVyaWFsRGVzaWduVmFsdWVBY2Nlc3NvckNvbXBvbmVudDxWYWx1ZVR5cGU+IHtcbiAgcmVhZG9ubHkgcmFuZ2UgPSBtb2RlbChmYWxzZSk7XG4gIHJlYWRvbmx5IHZhcmlhbnQgPSBtb2RlbDxEYXRlUGlja2VyVmFyaWFudD4oJ2Ryb3Bkb3duJyk7XG4gIHJlYWRvbmx5IGZpZWxkVmFyaWFudCA9IG1vZGVsPEZpZWxkVmFyaWFudD4oJ2ZpbGxlZCcpO1xuICByZWFkb25seSBwcmVmaXggPSBtb2RlbDxzdHJpbmc+KCk7XG4gIHJlYWRvbmx5IHN1ZmZpeCA9IG1vZGVsPHN0cmluZz4oKTtcbiAgcmVhZG9ubHkgbGFiZWwgPSBtb2RlbDxzdHJpbmc+KCk7XG4gIHJlYWRvbmx5IGZpZWxkID0gdmlld0NoaWxkPEZpZWxkQ29tcG9uZW50PFZhbHVlVHlwZT4+KCdmaWVsZCcpO1xuICByZWFkb25seSBkaWFsb2cgPSB2aWV3Q2hpbGQ8RGlhbG9nQ29tcG9uZW50PignZGlhbG9nJyk7XG5cbiAgcmVhZG9ubHkgcG9wdWxhdGVkID0gY29tcHV0ZWQoKCkgPT4ge1xuICAgIGlmICh0aGlzLmZpZWxkKCk/LnBvcG92ZXIoKT8uc3RhdGUoKSA9PT0gJ2Nsb3NpbmcnICYmICF0aGlzLnZhbHVlKCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIChcbiAgICAgICEhdGhpcy52YWx1ZSgpIHx8XG4gICAgICB0aGlzLmZpZWxkKCk/Lm9wZW4oKSB8fFxuICAgICAgdGhpcy5maWVsZCgpPy5wb3BvdmVyKCk/LnN0YXRlKCkgPT09ICdvcGVuaW5nJ1xuICAgICk7XG4gIH0pO1xuXG4gIHByaXZhdGUgcmVhZG9ubHkgX3RvZGF5ID0gbmV3IERhdGUoKTtcblxuICBvdmVycmlkZSByZWFkb25seSB2YWx1ZSA9IG1vZGVsPFZhbHVlVHlwZT4oKTtcbiAgcmVhZG9ubHkgc2VsZWN0aW9uVmFsdWUgPSBtb2RlbDxWYWx1ZVR5cGU+KHRoaXMudmFsdWUoKSk7XG5cbiAgcmVhZG9ubHkgY2FuT2theSA9IGNvbXB1dGVkKCgpID0+IHtcbiAgICBpZiAoXG4gICAgICB0aGlzLnJhbmdlKCkgJiZcbiAgICAgIHRoaXMuZnJvbVNlbGVjdGVkVmFsdWVBc0RhdGUgJiZcbiAgICAgICF0aGlzLnRvU2VsZWN0ZWRWYWx1ZUFzRGF0ZVxuICAgICkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSk7XG5cbiAgZ2V0IGZyb21WYWx1ZUFzRGF0ZSgpOiBEYXRlIHwgdW5kZWZpbmVkIHtcbiAgICBpZiAodGhpcy5yYW5nZSgpKSB7XG4gICAgICByZXR1cm4gdGhpcy52YWx1ZSgpPy5bMF0gPyBuZXcgRGF0ZSh0aGlzLnZhbHVlKCkhWzBdISkgOiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnZhbHVlKCkgPyBuZXcgRGF0ZSh0aGlzLnZhbHVlKCkgYXMgc3RyaW5nKSA6IHVuZGVmaW5lZDtcbiAgfVxuICBzZXQgZnJvbVZhbHVlQXNEYXRlKHZhbHVlOiBEYXRlIHwgdW5kZWZpbmVkKSB7XG4gICAgaWYgKHRoaXMucmFuZ2UoKSkge1xuICAgICAgdGhpcy52YWx1ZS51cGRhdGUoKHgpID0+IFt2YWx1ZT8udG9JU09TdHJpbmcoKSwgeD8uWzFdXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMudmFsdWUuc2V0KHZhbHVlPy50b0lTT1N0cmluZygpKTtcbiAgICB9XG4gIH1cblxuICBnZXQgdG9WYWx1ZUFzRGF0ZSgpOiBEYXRlIHwgdW5kZWZpbmVkIHtcbiAgICBpZiAoIXRoaXMucmFuZ2UoKSkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMudmFsdWUoKT8uWzFdID8gbmV3IERhdGUodGhpcy52YWx1ZSgpIVsxXSEpIDogdW5kZWZpbmVkO1xuICB9XG4gIHNldCB0b1ZhbHVlQXNEYXRlKHZhbHVlOiBEYXRlIHwgdW5kZWZpbmVkKSB7XG4gICAgaWYgKCF0aGlzLnJhbmdlKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy52YWx1ZS51cGRhdGUoKHgpID0+IFt4Py5bMF0sIHZhbHVlPy50b0lTT1N0cmluZygpXSk7XG4gIH1cblxuICBnZXQgZnJvbVNlbGVjdGVkVmFsdWVBc0RhdGUoKTogRGF0ZSB8IHVuZGVmaW5lZCB7XG4gICAgaWYgKHRoaXMucmFuZ2UoKSkge1xuICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0aW9uVmFsdWUoKT8uWzBdXG4gICAgICAgID8gbmV3IERhdGUodGhpcy5zZWxlY3Rpb25WYWx1ZSgpIVswXSEpXG4gICAgICAgIDogdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5zZWxlY3Rpb25WYWx1ZSgpXG4gICAgICA/IG5ldyBEYXRlKHRoaXMuc2VsZWN0aW9uVmFsdWUoKSBhcyBzdHJpbmcpXG4gICAgICA6IHVuZGVmaW5lZDtcbiAgfVxuICBzZXQgZnJvbVNlbGVjdGVkVmFsdWVBc0RhdGUodmFsdWU6IERhdGUgfCB1bmRlZmluZWQpIHtcbiAgICBpZiAodGhpcy5yYW5nZSgpKSB7XG4gICAgICB0aGlzLnNlbGVjdGlvblZhbHVlLnVwZGF0ZSgoeCkgPT4gW3ZhbHVlPy50b0lTT1N0cmluZygpLCB4Py5bMV1dKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zZWxlY3Rpb25WYWx1ZS5zZXQodmFsdWU/LnRvSVNPU3RyaW5nKCkpO1xuICAgIH1cbiAgfVxuXG4gIGdldCB0b1NlbGVjdGVkVmFsdWVBc0RhdGUoKTogRGF0ZSB8IHVuZGVmaW5lZCB7XG4gICAgaWYgKCF0aGlzLnJhbmdlKCkpIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnNlbGVjdGlvblZhbHVlKCk/LlsxXVxuICAgICAgPyBuZXcgRGF0ZSh0aGlzLnNlbGVjdGlvblZhbHVlKCkhWzFdISlcbiAgICAgIDogdW5kZWZpbmVkO1xuICB9XG4gIHNldCB0b1NlbGVjdGVkVmFsdWVBc0RhdGUodmFsdWU6IERhdGUgfCB1bmRlZmluZWQpIHtcbiAgICBpZiAoIXRoaXMucmFuZ2UoKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnNlbGVjdGlvblZhbHVlLnVwZGF0ZSgoeCkgPT4gW3g/LlswXSwgdmFsdWU/LnRvSVNPU3RyaW5nKCldKTtcbiAgfVxuXG4gIHJlYWRvbmx5IGxvY2FsZSA9IG1vZGVsKCdlbicpO1xuXG4gIHJlYWRvbmx5IG1vbnRoSXRlbXMgPSB2aWV3Q2hpbGRyZW48TGlzdEl0ZW1Db21wb25lbnQ+KCdtb250aEl0ZW0nKTtcbiAgcmVhZG9ubHkgbW9udGhWaWV3ID0gbW9kZWwodGhpcy5fdG9kYXkuZ2V0TW9udGgoKSk7XG4gIHJlYWRvbmx5IG1vbnRoVmlld1RleHQgPSBjb21wdXRlZCgoKSA9PiB7XG4gICAgY29uc3QgbW9udGggPSB0aGlzLm1vbnRoVmlldygpO1xuICAgIGNvbnN0IGRhdGUgPSB0aGlzLmZyb21TZWxlY3RlZFZhbHVlQXNEYXRlID8/IG5ldyBEYXRlKHRoaXMuX3RvZGF5KTtcbiAgICBkYXRlLnNldE1vbnRoKG1vbnRoKTtcbiAgICBjb25zdCBkYXRlU3RyaW5nID0gZGF0ZS50b0xvY2FsZURhdGVTdHJpbmcodGhpcy5sb2NhbGUoKSwge1xuICAgICAgbW9udGg6ICdzaG9ydCcsXG4gICAgfSk7XG4gICAgcmV0dXJuIGRhdGVTdHJpbmc7XG4gIH0pO1xuICByZWFkb25seSBtb250aHMgPSBjb21wdXRlZCgoKSA9PiB7XG4gICAgY29uc3QgZm9ybWF0dGVyID0gbmV3IEludGwuRGF0ZVRpbWVGb3JtYXQodGhpcy5sb2NhbGUoKSwgeyBtb250aDogJ2xvbmcnIH0pO1xuICAgIHJldHVybiBBcnJheS5mcm9tKHsgbGVuZ3RoOiAxMiB9LCAoXywgdmFsdWUpID0+ICh7XG4gICAgICB0ZXh0OiBmb3JtYXR0ZXIuZm9ybWF0KG5ldyBEYXRlKDAsIHZhbHVlKSksXG4gICAgICB2YWx1ZSxcbiAgICB9KSk7XG4gIH0pO1xuXG4gIHJlYWRvbmx5IG1vbnRoVmlld09wZW4gPSBzaWduYWwoZmFsc2UpO1xuICByZWFkb25seSBtb250aFZpZXdTdGF0ZSA9IHRvU2lnbmFsKG9wZW5DbG9zZSh0aGlzLm1vbnRoVmlld09wZW4sICdzaG9ydDQnKSwge1xuICAgIGluaXRpYWxWYWx1ZTogJ2Nsb3NlZCcsXG4gIH0pO1xuXG4gIHJlYWRvbmx5IHllYXJJdGVtcyA9IHZpZXdDaGlsZHJlbjxCdXR0b25Db21wb25lbnQ+KCd5ZWFySXRlbScpO1xuICByZWFkb25seSB5ZWFyVmlldyA9IG1vZGVsKHRoaXMuX3RvZGF5LmdldEZ1bGxZZWFyKCkpO1xuICByZWFkb25seSB5ZWFyVmlld1RleHQgPSBjb21wdXRlZCgoKSA9PiB7XG4gICAgY29uc3QgeWVhciA9IHRoaXMueWVhclZpZXcoKTtcbiAgICBjb25zdCBkYXRlID0gdGhpcy5mcm9tU2VsZWN0ZWRWYWx1ZUFzRGF0ZSA/PyBuZXcgRGF0ZSh0aGlzLl90b2RheSk7XG4gICAgZGF0ZS5zZXRGdWxsWWVhcih5ZWFyKTtcbiAgICBjb25zdCBkYXRlU3RyaW5nID0gZGF0ZS50b0xvY2FsZURhdGVTdHJpbmcodGhpcy5sb2NhbGUoKSwge1xuICAgICAgeWVhcjogJ251bWVyaWMnLFxuICAgIH0pO1xuICAgIHJldHVybiBkYXRlU3RyaW5nO1xuICB9KTtcbiAgZ2V0IHllYXJzKCkge1xuICAgIGNvbnN0IGN1cnJlbnRZZWFyID0gbmV3IERhdGUoKS5nZXRGdWxsWWVhcigpO1xuICAgIGNvbnN0IHN0YXJ0WWVhciA9IGN1cnJlbnRZZWFyIC0gNTA7XG4gICAgY29uc3QgZW5kWWVhciA9IGN1cnJlbnRZZWFyICsgMjA7XG4gICAgcmV0dXJuIEFycmF5LmZyb20oXG4gICAgICB7IGxlbmd0aDogZW5kWWVhciAtIHN0YXJ0WWVhciArIDEgfSxcbiAgICAgIChfLCB2YWx1ZSkgPT4gc3RhcnRZZWFyICsgdmFsdWVcbiAgICApO1xuICB9XG5cbiAgcmVhZG9ubHkgeWVhclZpZXdPcGVuID0gc2lnbmFsKGZhbHNlKTtcbiAgcmVhZG9ubHkgeWVhclZpZXdTdGF0ZSA9IHRvU2lnbmFsKG9wZW5DbG9zZSh0aGlzLnllYXJWaWV3T3BlbiwgJ3Nob3J0NCcpLCB7XG4gICAgaW5pdGlhbFZhbHVlOiAnY2xvc2VkJyxcbiAgfSk7XG5cbiAgcmVhZG9ubHkgZGF5TmFtZXMgPSBjb21wdXRlZCgoKSA9PiB7XG4gICAgY29uc3QgZm9ybWF0dGVyID0gbmV3IEludGwuRGF0ZVRpbWVGb3JtYXQodGhpcy5sb2NhbGUoKSwge1xuICAgICAgd2Vla2RheTogJ25hcnJvdycsXG4gICAgfSk7XG4gICAgcmV0dXJuIEFycmF5LmZyb20oeyBsZW5ndGg6IDcgfSwgKF8sIGkpID0+XG4gICAgICBmb3JtYXR0ZXIuZm9ybWF0KG5ldyBEYXRlKDE5NzAsIDAsIGkgKyA0KSlcbiAgICApO1xuICB9KTtcbiAgcmVhZG9ubHkgZGF5cyA9IGNvbXB1dGVkKCgpID0+IHtcbiAgICBjb25zdCBtb250aCA9IHRoaXMubW9udGhWaWV3KCk7XG4gICAgY29uc3QgeWVhciA9IHRoaXMueWVhclZpZXcoKTtcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoeWVhciwgbW9udGgpO1xuICAgIGNvbnN0IGZpcnN0RGF5T2ZNb250aCA9IG5ldyBEYXRlKFxuICAgICAgZGF0ZS5nZXRGdWxsWWVhcigpLFxuICAgICAgZGF0ZS5nZXRNb250aCgpLFxuICAgICAgMVxuICAgICkuZ2V0RGF5KCk7XG4gICAgY29uc3Qgc3RhcnREYXRlID0gbmV3IERhdGUoXG4gICAgICBkYXRlLmdldEZ1bGxZZWFyKCksXG4gICAgICBkYXRlLmdldE1vbnRoKCksXG4gICAgICAxIC0gZmlyc3REYXlPZk1vbnRoXG4gICAgKTtcbiAgICBjb25zdCBjYWxlbmRhckRheXM6IERheVtdID0gW107XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDQyOyBpKyspIHtcbiAgICAgIGNvbnN0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoc3RhcnREYXRlKTtcbiAgICAgIGN1cnJlbnREYXRlLnNldERhdGUoc3RhcnREYXRlLmdldERhdGUoKSArIGkpO1xuICAgICAgY29uc3QgZGF5ID0gY3VycmVudERhdGUuZ2V0RGF0ZSgpO1xuICAgICAgbGV0IHR5cGUgPSAnY3VycmVudCc7XG5cbiAgICAgIGlmIChjdXJyZW50RGF0ZS5nZXRNb250aCgpIDwgZGF0ZS5nZXRNb250aCgpKSB7XG4gICAgICAgIHR5cGUgPSAncHJldmlvdXMnO1xuICAgICAgfSBlbHNlIGlmIChjdXJyZW50RGF0ZS5nZXRNb250aCgpID4gZGF0ZS5nZXRNb250aCgpKSB7XG4gICAgICAgIHR5cGUgPSAnbmV4dCc7XG4gICAgICB9XG5cbiAgICAgIGNhbGVuZGFyRGF5cy5wdXNoKHsgZGF5LCB0eXBlLCBkYXRlOiBjdXJyZW50RGF0ZSB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gY2FsZW5kYXJEYXlzO1xuICB9KTtcblxuICBwcml2YXRlIGZyb21TZWxlY3Rpb24gPSB0cnVlO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG4gICAgZWZmZWN0KFxuICAgICAgKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy52YXJpYW50KCkgPT09ICdlbWJlZGRlZCcpIHtcbiAgICAgICAgICB0aGlzLnZhbHVlLnNldCh0aGlzLnNlbGVjdGlvblZhbHVlKCkpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBhbGxvd1NpZ25hbFdyaXRlczogdHJ1ZSxcbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgb3Blbk1vbnRoVmlldygpIHtcbiAgICB0aGlzLnllYXJWaWV3T3Blbi5zZXQoZmFsc2UpO1xuICAgIHRoaXMubW9udGhWaWV3T3Blbi5zZXQoIXRoaXMubW9udGhWaWV3T3BlbigpKTtcbiAgICBjb25zdCBzZWxlY3RlZEl0ZW0gPSB0aGlzLm1vbnRoSXRlbXMoKS5maW5kKCh4KSA9PiB4LnNlbGVjdGVkKCkpO1xuICAgIHNlbGVjdGVkSXRlbT8uaG9zdEVsZW1lbnQuc2Nyb2xsSW50b1ZpZXcoe1xuICAgICAgYmxvY2s6ICduZWFyZXN0JyxcbiAgICB9KTtcbiAgfVxuXG4gIG1vbnRoSXRlbUNsaWNrKG1vbnRoOiBudW1iZXIpIHtcbiAgICB0aGlzLm1vbnRoVmlldy5zZXQobW9udGgpO1xuICAgIHRoaXMubW9udGhWaWV3T3Blbi5zZXQoZmFsc2UpO1xuICB9XG5cbiAgb3BlblllYXJWaWV3KCkge1xuICAgIHRoaXMubW9udGhWaWV3T3Blbi5zZXQoZmFsc2UpO1xuICAgIHRoaXMueWVhclZpZXdPcGVuLnNldCghdGhpcy55ZWFyVmlld09wZW4oKSk7XG4gICAgY29uc3Qgc2VsZWN0ZWRJdGVtID0gdGhpcy55ZWFySXRlbXMoKS5maW5kKCh4KSA9PiB4LnZhcmlhbnQoKSA9PT0gJ2ZpbGxlZCcpO1xuICAgIHNlbGVjdGVkSXRlbT8uaG9zdEVsZW1lbnQuc2Nyb2xsSW50b1ZpZXcoe1xuICAgICAgYmxvY2s6ICduZWFyZXN0JyxcbiAgICB9KTtcbiAgfVxuXG4gIHllYXJJdGVtQ2xpY2soeWVhcjogbnVtYmVyKSB7XG4gICAgdGhpcy55ZWFyVmlldy5zZXQoeWVhcik7XG4gICAgdGhpcy55ZWFyVmlld09wZW4uc2V0KGZhbHNlKTtcbiAgfVxuXG4gIHRvZGF5Q2xpY2soKSB7XG4gICAgdGhpcy5tb250aFZpZXcuc2V0KHRoaXMuX3RvZGF5LmdldE1vbnRoKCkpO1xuICAgIHRoaXMueWVhclZpZXcuc2V0KHRoaXMuX3RvZGF5LmdldEZ1bGxZZWFyKCkpO1xuICB9XG5cbiAgZGF5Q2xpY2soZGF5OiBEYXkpIHtcbiAgICBpZiAodGhpcy5mcm9tU2VsZWN0aW9uKSB7XG4gICAgICB0aGlzLmZyb21TZWxlY3RlZFZhbHVlQXNEYXRlID0gZGF5LmRhdGU7XG4gICAgICB0aGlzLnRvU2VsZWN0ZWRWYWx1ZUFzRGF0ZSA9IHVuZGVmaW5lZDtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKFxuICAgICAgICB0aGlzLmZyb21TZWxlY3RlZFZhbHVlQXNEYXRlICYmXG4gICAgICAgIGRheS5kYXRlIDwgdGhpcy5mcm9tU2VsZWN0ZWRWYWx1ZUFzRGF0ZVxuICAgICAgKSB7XG4gICAgICAgIHRoaXMuZnJvbVNlbGVjdGlvbiA9ICF0aGlzLmZyb21TZWxlY3Rpb247XG4gICAgICAgIHRoaXMuZGF5Q2xpY2soZGF5KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy50b1NlbGVjdGVkVmFsdWVBc0RhdGUgPSBkYXkuZGF0ZTtcbiAgICB9XG4gICAgdGhpcy5tb250aFZpZXcuc2V0KGRheS5kYXRlLmdldE1vbnRoKCkpO1xuICAgIHRoaXMueWVhclZpZXcuc2V0KGRheS5kYXRlLmdldEZ1bGxZZWFyKCkpO1xuICAgIGlmICh0aGlzLnJhbmdlKCkpIHtcbiAgICAgIHRoaXMuZnJvbVNlbGVjdGlvbiA9ICF0aGlzLmZyb21TZWxlY3Rpb247XG4gICAgfVxuICB9XG5cbiAgaXNEYXRlRXF1YWwoZGF0ZUE/OiBEYXRlLCBkYXRlQj86IERhdGUpIHtcbiAgICByZXR1cm4gKFxuICAgICAgZGF0ZUE/LmdldEZ1bGxZZWFyKCkgPT09IGRhdGVCPy5nZXRGdWxsWWVhcigpICYmXG4gICAgICBkYXRlQT8uZ2V0TW9udGgoKSA9PT0gZGF0ZUI/LmdldE1vbnRoKCkgJiZcbiAgICAgIGRhdGVBPy5nZXREYXRlKCkgPT09IGRhdGVCPy5nZXREYXRlKClcbiAgICApO1xuICB9XG5cbiAgaXNUb2RheShkYXRlOiBEYXRlKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIHRoaXMuX3RvZGF5LmdldEZ1bGxZZWFyKCkgPT09IGRhdGUuZ2V0RnVsbFllYXIoKSAmJlxuICAgICAgdGhpcy5fdG9kYXkuZ2V0TW9udGgoKSA9PT0gZGF0ZS5nZXRNb250aCgpICYmXG4gICAgICB0aGlzLl90b2RheS5nZXREYXRlKCkgPT09IGRhdGUuZ2V0RGF0ZSgpXG4gICAgKTtcbiAgfVxuXG4gIGlzRGF5U2VsZWN0ZWQoZGF0ZTogRGF0ZSkge1xuICAgIHJldHVybiAoXG4gICAgICB0aGlzLmlzRGF0ZUVxdWFsKHRoaXMuZnJvbVNlbGVjdGVkVmFsdWVBc0RhdGUsIGRhdGUpIHx8XG4gICAgICB0aGlzLmlzRGF0ZUVxdWFsKHRoaXMudG9TZWxlY3RlZFZhbHVlQXNEYXRlLCBkYXRlKVxuICAgICk7XG4gIH1cblxuICBpc0luUmFuZ2UoZGF0ZTogRGF0ZSkge1xuICAgIGlmICghdGhpcy5mcm9tU2VsZWN0ZWRWYWx1ZUFzRGF0ZSB8fCAhdGhpcy50b1NlbGVjdGVkVmFsdWVBc0RhdGUpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIChcbiAgICAgIGRhdGUgPj0gdGhpcy5mcm9tU2VsZWN0ZWRWYWx1ZUFzRGF0ZSAmJiBkYXRlIDw9IHRoaXMudG9TZWxlY3RlZFZhbHVlQXNEYXRlXG4gICAgKTtcbiAgfVxuXG4gIGNsZWFyQ2xpY2soKSB7XG4gICAgdGhpcy5mcm9tU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICB0aGlzLnZhbHVlLnNldCh1bmRlZmluZWQpO1xuICAgIHRoaXMuc2VsZWN0aW9uVmFsdWUuc2V0KHVuZGVmaW5lZCk7XG4gIH1cblxuICBva2F5Q2xpY2soKSB7XG4gICAgdGhpcy5mcm9tU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICB0aGlzLnZhbHVlLnNldCh0aGlzLnNlbGVjdGlvblZhbHVlKCkpO1xuICAgIHRoaXMubW9udGhWaWV3LnNldChcbiAgICAgIHRoaXMuZnJvbVNlbGVjdGVkVmFsdWVBc0RhdGU/LmdldE1vbnRoKCkgPz8gdGhpcy5fdG9kYXkuZ2V0TW9udGgoKVxuICAgICk7XG4gICAgdGhpcy55ZWFyVmlldy5zZXQoXG4gICAgICB0aGlzLmZyb21TZWxlY3RlZFZhbHVlQXNEYXRlPy5nZXRGdWxsWWVhcigpID8/IHRoaXMuX3RvZGF5LmdldEZ1bGxZZWFyKClcbiAgICApO1xuICAgIGlmICh0aGlzLnZhcmlhbnQoKSA9PT0gJ2Ryb3Bkb3duJykge1xuICAgICAgdGhpcy5maWVsZCgpPy5vcGVuLnNldChmYWxzZSk7XG4gICAgfVxuICAgIGlmICh0aGlzLnZhcmlhbnQoKSA9PT0gJ2RpYWxvZycpIHtcbiAgICAgIHRoaXMuZGlhbG9nKCk/Lm9wZW4uc2V0KGZhbHNlKTtcbiAgICB9XG4gICAgdGhpcy5tb250aFZpZXdPcGVuLnNldChmYWxzZSk7XG4gICAgdGhpcy55ZWFyVmlld09wZW4uc2V0KGZhbHNlKTtcbiAgfVxuXG4gIGNhbmNlbENsaWNrKCkge1xuICAgIHRoaXMuZnJvbVNlbGVjdGlvbiA9IHRydWU7XG4gICAgdGhpcy5zZWxlY3Rpb25WYWx1ZS5zZXQodGhpcy52YWx1ZSgpKTtcbiAgICB0aGlzLm1vbnRoVmlldy5zZXQoXG4gICAgICB0aGlzLmZyb21TZWxlY3RlZFZhbHVlQXNEYXRlPy5nZXRNb250aCgpID8/IHRoaXMuX3RvZGF5LmdldE1vbnRoKClcbiAgICApO1xuICAgIHRoaXMueWVhclZpZXcuc2V0KFxuICAgICAgdGhpcy5mcm9tU2VsZWN0ZWRWYWx1ZUFzRGF0ZT8uZ2V0RnVsbFllYXIoKSA/PyB0aGlzLl90b2RheS5nZXRGdWxsWWVhcigpXG4gICAgKTtcbiAgICBpZiAodGhpcy52YXJpYW50KCkgPT09ICdkcm9wZG93bicpIHtcbiAgICAgIHRoaXMuZmllbGQoKT8ub3Blbi5zZXQoZmFsc2UpO1xuICAgIH1cbiAgICBpZiAodGhpcy52YXJpYW50KCkgPT09ICdkaWFsb2cnKSB7XG4gICAgICB0aGlzLmRpYWxvZygpPy5vcGVuLnNldChmYWxzZSk7XG4gICAgfVxuICAgIHRoaXMubW9udGhWaWV3T3Blbi5zZXQoZmFsc2UpO1xuICAgIHRoaXMueWVhclZpZXdPcGVuLnNldChmYWxzZSk7XG4gIH1cblxuICBib2R5Q2xpY2soKSB7XG4gICAgaWYgKHRoaXMudmFyaWFudCgpICE9PSAnZGlhbG9nJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmRpYWxvZygpPy5vcGVuLnNldCh0cnVlKTtcbiAgfVxuXG4gIHBvcG92ZXJTdGF0ZUNoYW5nZShzdGF0ZTogT3BlbkNsb3NlU3RhdGUpIHtcbiAgICBpZiAoc3RhdGUgPT09ICdjbG9zZWQnKSB7XG4gICAgICB0aGlzLmNhbmNlbENsaWNrKCk7XG4gICAgfVxuICB9XG59XG4iLCI8bmctdGVtcGxhdGUgI2FjdGlvbnM+XG4gIDxtZC1idXR0b24gW2F0dHIuc2xvdF09XCJ2YXJpYW50KCkgPT09ICdkaWFsb2cnID8gJ2FjdGlvbicgOiBudWxsXCIgdmFyaWFudD1cInRleHRcIiBjbGFzcz1cImNsZWFyXCIgKGNsaWNrKT1cImNsZWFyQ2xpY2soKVwiXG4gICAgaTE4bj5DbGVhcjwvbWQtYnV0dG9uPlxuICBAaWYgKHZhcmlhbnQoKSAhPT0gJ2VtYmVkZGVkJykge1xuICA8bWQtYnV0dG9uIFthdHRyLnNsb3RdPVwidmFyaWFudCgpID09PSAnZGlhbG9nJyA/ICdhY3Rpb24nIDogbnVsbFwiIHZhcmlhbnQ9XCJ0ZXh0XCIgKGNsaWNrKT1cIm9rYXlDbGljaygpXCJcbiAgICBbZGlzYWJsZWRdPVwiIWNhbk9rYXkoKVwiIGkxOG4+T2theTwvbWQtYnV0dG9uPlxuICA8bWQtYnV0dG9uIFthdHRyLnNsb3RdPVwidmFyaWFudCgpID09PSAnZGlhbG9nJyA/ICdhY3Rpb24nIDogbnVsbFwiIHZhcmlhbnQ9XCJ0ZXh0XCIgKGNsaWNrKT1cImNhbmNlbENsaWNrKClcIlxuICAgIGkxOG4+Q2FuY2VsPC9tZC1idXR0b24+XG4gIH1cbjwvbmctdGVtcGxhdGU+XG5cbjxuZy10ZW1wbGF0ZSAjY29udGVudHM+XG4gIDxkaXYgY2xhc3M9XCJjb250YWluZXJcIj5cbiAgICA8ZGl2IGNsYXNzPVwiaGVhZGVyXCI+XG4gICAgICA8ZGl2IGNsYXNzPVwibW9udGhzXCI+XG4gICAgICAgIDxtZC1idXR0b24gdmFyaWFudD1cInBsYWluXCIgY2xhc3M9XCJuYXZpZ2F0ZVwiIChjbGljayk9XCJtb250aFZpZXcuc2V0KG1vbnRoVmlldygpIC0gMSlcIj5cbiAgICAgICAgICA8bWQtaWNvbj5jaGV2cm9uX2xlZnQ8L21kLWljb24+XG4gICAgICAgIDwvbWQtYnV0dG9uPlxuICAgICAgICA8bWQtYnV0dG9uICNtb250aFZpZXdCdXR0b24gdmFyaWFudD1cInBsYWluXCIgKGNsaWNrKT1cIm9wZW5Nb250aFZpZXcoKVwiPlxuICAgICAgICAgIHt7IG1vbnRoVmlld1RleHQoKSB9fVxuICAgICAgICAgIDxtZC1pY29uIGNsYXNzPVwibW9udGgtaWNvblwiIHNsb3Q9XCJ0cmFpbGluZ1wiPmFycm93X2Ryb3BfZG93bjwvbWQtaWNvbj5cbiAgICAgICAgPC9tZC1idXR0b24+XG4gICAgICAgIDxtZC1idXR0b24gdmFyaWFudD1cInBsYWluXCIgY2xhc3M9XCJuYXZpZ2F0ZVwiIChjbGljayk9XCJtb250aFZpZXcuc2V0KG1vbnRoVmlldygpICsgMSlcIj5cbiAgICAgICAgICA8bWQtaWNvbj5jaGV2cm9uX3JpZ2h0PC9tZC1pY29uPlxuICAgICAgICA8L21kLWJ1dHRvbj5cbiAgICAgIDwvZGl2PlxuICAgICAgQGlmICh2YXJpYW50KCkgPT09ICdkcm9wZG93bicpIHtcbiAgICAgIDxtZC1pY29uLWJ1dHRvbiAjdG9kYXkgKGNsaWNrKT1cInRvZGF5Q2xpY2soKVwiPnRvZGF5PC9tZC1pY29uLWJ1dHRvbj5cbiAgICAgIDxtZC10b29sdGlwIFt0YXJnZXRdPVwidG9kYXlcIiBpMThuPlRvZGF5PC9tZC10b29sdGlwPlxuICAgICAgfSBAZWxzZSB7XG4gICAgICA8bWQtYnV0dG9uIHZhcmlhbnQ9XCJ0ZXh0XCIgKGNsaWNrKT1cInRvZGF5Q2xpY2soKVwiIGkxOG4+VG9kYXk8L21kLWJ1dHRvbj5cbiAgICAgIH1cbiAgICAgIDxkaXYgY2xhc3M9XCJ5ZWFyc1wiPlxuICAgICAgICA8bWQtYnV0dG9uIHZhcmlhbnQ9XCJwbGFpblwiIGNsYXNzPVwibmF2aWdhdGVcIiAoY2xpY2spPVwieWVhclZpZXcuc2V0KHllYXJWaWV3KCkgLSAxKVwiPlxuICAgICAgICAgIDxtZC1pY29uPmNoZXZyb25fbGVmdDwvbWQtaWNvbj5cbiAgICAgICAgPC9tZC1idXR0b24+XG4gICAgICAgIDxtZC1idXR0b24gdmFyaWFudD1cInBsYWluXCIgKGNsaWNrKT1cIm9wZW5ZZWFyVmlldygpXCI+XG4gICAgICAgICAge3sgeWVhclZpZXdUZXh0KCkgfX1cbiAgICAgICAgICA8bWQtaWNvbiBzbG90PVwidHJhaWxpbmdcIj5hcnJvd19kcm9wX2Rvd248L21kLWljb24+XG4gICAgICAgIDwvbWQtYnV0dG9uPlxuICAgICAgICA8bWQtYnV0dG9uIHZhcmlhbnQ9XCJwbGFpblwiIGNsYXNzPVwibmF2aWdhdGVcIiAoY2xpY2spPVwieWVhclZpZXcuc2V0KHllYXJWaWV3KCkgKyAxKVwiPlxuICAgICAgICAgIDxtZC1pY29uPmNoZXZyb25fcmlnaHQ8L21kLWljb24+XG4gICAgICAgIDwvbWQtYnV0dG9uPlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICAgPGRpdiBjbGFzcz1cImJvZHlcIj5cbiAgICAgIDxkaXYgY2xhc3M9XCJ2aWV3XCIgW25nQ2xhc3NdPVwibW9udGhWaWV3U3RhdGUoKVwiPlxuICAgICAgICBAZm9yIChtb250aCBvZiBtb250aHMoKTsgdHJhY2sgJGluZGV4KSB7XG4gICAgICAgIDxtZC1saXN0LWl0ZW0gI21vbnRoSXRlbSBbc2VsZWN0ZWRdPVwibW9udGhWaWV3KCkgPT09IG1vbnRoLnZhbHVlXCIgKGNsaWNrKT1cIm1vbnRoSXRlbUNsaWNrKG1vbnRoLnZhbHVlKVwiXG4gICAgICAgICAgdHlwZT1cImJ1dHRvblwiPlxuICAgICAgICAgIHt7IG1vbnRoLnRleHQgfX1cbiAgICAgICAgPC9tZC1saXN0LWl0ZW0+XG4gICAgICAgIH1cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBjbGFzcz1cInZpZXcgeWVhci12aWV3XCIgW25nQ2xhc3NdPVwieWVhclZpZXdTdGF0ZSgpXCI+XG4gICAgICAgIEBmb3IgKHllYXIgb2YgeWVhcnM7IHRyYWNrICRpbmRleCkge1xuICAgICAgICA8bWQtYnV0dG9uICN5ZWFySXRlbSBbdmFyaWFudF09XCJ5ZWFyVmlldygpID09PSB5ZWFyID8gJ2ZpbGxlZCcgOiAndGV4dCdcIiAoY2xpY2spPVwieWVhckl0ZW1DbGljayh5ZWFyKVwiPlxuICAgICAgICAgIHt7IHllYXIgfX1cbiAgICAgICAgPC9tZC1idXR0b24+XG4gICAgICAgIH1cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBjbGFzcz1cImNhbGVuZGFyXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJkYXlzIGRheS1uYW1lc1wiPlxuICAgICAgICAgIEBmb3IgKGRheU5hbWUgb2YgZGF5TmFtZXMoKTsgdHJhY2sgJGluZGV4KSB7XG4gICAgICAgICAgPGRpdiBjbGFzcz1cImRheS1jb250YWluZXJcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJkYXktbmFtZVwiPnt7IGRheU5hbWUgfX08L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICB9XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZGF5c1wiPlxuICAgICAgICAgIEBmb3IgKGRheSBvZiBkYXlzKCk7IHRyYWNrICRpbmRleCkge1xuICAgICAgICAgIDxkaXYgY2xhc3M9XCJkYXktY29udGFpbmVyXCI+XG4gICAgICAgICAgICBAaWYgKGlzSW5SYW5nZShkYXkuZGF0ZSkpIHtcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJpbi1yYW5nZS1pbmRpY2F0b3JcIiBbY2xhc3MuZmlyc3RdPVwiaXNEYXRlRXF1YWwoZnJvbVNlbGVjdGVkVmFsdWVBc0RhdGUsIGRheS5kYXRlKVwiXG4gICAgICAgICAgICAgIFtjbGFzcy5sYXN0XT1cImlzRGF0ZUVxdWFsKHRvU2VsZWN0ZWRWYWx1ZUFzRGF0ZSwgZGF5LmRhdGUpXCIgW2NsYXNzLm5vdC1jdXJyZW50XT1cImRheS50eXBlICE9PSAnY3VycmVudCdcIj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgPG1kLWljb24tYnV0dG9uIFtjdXN0b21dPVwidHJ1ZVwiIFtzZWxlY3RlZF09XCJpc0RheVNlbGVjdGVkKGRheS5kYXRlKVwiXG4gICAgICAgICAgICAgIFt2YXJpYW50XT1cImlzRGF5U2VsZWN0ZWQoZGF5LmRhdGUpID8gJ2ZpbGxlZCcgOiAnc3RhbmRhcmQnXCIgW2NsYXNzLm5vdC1jdXJyZW50XT1cImRheS50eXBlICE9PSAnY3VycmVudCdcIlxuICAgICAgICAgICAgICBbY2xhc3MudG9kYXldPVwiaXNUb2RheShkYXkuZGF0ZSlcIiAoY2xpY2spPVwiZGF5Q2xpY2soZGF5KVwiIFtjbGFzcy5pbi1yYW5nZV09XCJpc0luUmFuZ2UoZGF5LmRhdGUpXCI+e3tcbiAgICAgICAgICAgICAgZGF5LmRheVxuICAgICAgICAgICAgICB9fTwvbWQtaWNvbi1idXR0b24+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgfVxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICAgIEBpZiAodmFyaWFudCgpICE9PSAnZGlhbG9nJykge1xuICAgIDxkaXYgY2xhc3M9XCJhY3Rpb25zXCI+XG4gICAgICA8bmctY29udGFpbmVyICpuZ1RlbXBsYXRlT3V0bGV0PVwiYWN0aW9uc1wiIC8+XG4gICAgPC9kaXY+XG4gICAgfVxuICA8L2Rpdj5cbjwvbmctdGVtcGxhdGU+XG5cbkBpZiAodmFyaWFudCgpID09PSAnZW1iZWRkZWQnKSB7XG48bmctY29udGFpbmVyICpuZ1RlbXBsYXRlT3V0bGV0PVwiY29udGVudHNcIiAvPlxufSBAZWxzZSB7XG48bWQtZmllbGQgI2ZpZWxkIFt2YXJpYW50XT1cImZpZWxkVmFyaWFudCgpXCIgW3BvcHVsYXRlZF09XCIhIXBvcHVsYXRlZCgpXCIgW2Vycm9yVGV4dF09XCJlcnJvclRleHQoKVwiIFtsYWJlbF09XCJsYWJlbCgpXCJcbiAgW2Rpc2FibGVkXT1cImRpc2FibGVkKClcIiAoYm9keUNsaWNrKT1cImJvZHlDbGljaygpXCIgKHBvcG92ZXJTdGF0ZUNoYW5nZSk9XCJwb3BvdmVyU3RhdGVDaGFuZ2UoJGV2ZW50KVwiPlxuICA8c2xvdCBuYW1lPVwibGVhZGluZ1wiIHNsb3Q9XCJsZWFkaW5nXCI+PC9zbG90PlxuICA8c2xvdCBuYW1lPVwicHJlZml4XCIgc2xvdD1cInByZWZpeFwiPjwvc2xvdD5cbiAgPHNsb3QgbmFtZT1cInN1ZmZpeFwiIHNsb3Q9XCJzdWZmaXhcIj48L3Nsb3Q+XG4gIDxzbG90IG5hbWU9XCJzdXBwb3J0aW5nLXRleHRcIiBzbG90PVwic3VwcG9ydGluZy10ZXh0XCI+PC9zbG90PlxuICA8c2xvdCBuYW1lPVwiY291bnRlclwiIHNsb3Q9XCJjb3VudGVyXCI+PC9zbG90PlxuICA8c3BhbiBjbGFzcz1cInNlbGVjdGVkLXZhbHVlXCI+XG4gICAgQGlmICghZnJvbVZhbHVlQXNEYXRlKSB7XG4gICAgPHNwYW4gaTE4bj5TZWxlY3QgYSBkYXRlLi4uPC9zcGFuPlxuICAgIH0gQGVsc2Uge1xuICAgIDxzcGFuPnt7IGZyb21WYWx1ZUFzRGF0ZSB8IGRhdGVGb3JtYXQ6IHRoaXMubG9jYWxlKCk6ICdkZCBNTU0geXl5eScgfX08L3NwYW4+XG4gICAgQGlmIChyYW5nZSgpKSB7XG4gICAgPHNwYW4+LTwvc3Bhbj5cbiAgICA8c3Bhbj57eyB0b1ZhbHVlQXNEYXRlIHwgZGF0ZUZvcm1hdDogdGhpcy5sb2NhbGUoKTogJ2RkIE1NTSB5eXl5JyB9fTwvc3Bhbj5cbiAgICB9XG4gICAgfVxuICA8L3NwYW4+XG4gIDxtZC1pY29uIHNsb3Q9XCJ0cmFpbGluZ1wiPmNhbGVuZGFyX21vbnRoPC9tZC1pY29uPlxuICBAaWYgKHZhcmlhbnQoKSA9PT0gJ2Ryb3Bkb3duJykge1xuICA8ZGl2IGNsYXNzPVwicG9wb3ZlclwiIHNsb3Q9XCJwb3BvdmVyXCI+XG4gICAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cImNvbnRlbnRzXCIgLz5cbiAgPC9kaXY+XG4gIH1cbjwvbWQtZmllbGQ+XG5AaWYgKHZhcmlhbnQoKSA9PT0gJ2RpYWxvZycpIHtcbjxtZC1kaWFsb2cgI2RpYWxvZyAoc3RhdGVDaGFuZ2UpPVwicG9wb3ZlclN0YXRlQ2hhbmdlKCRldmVudClcIj5cbiAgPG1kLWljb24gc2xvdD1cImljb25cIj5jYWxlbmRhcl9tb250aDwvbWQtaWNvbj5cbiAgPHNwYW4gY2xhc3M9XCJzZWxlY3RlZC12YWx1ZVwiIHNsb3Q9XCJoZWFkbGluZVwiPlxuICAgIEBpZiAoIWZyb21TZWxlY3RlZFZhbHVlQXNEYXRlKSB7XG4gICAgPHNwYW4gaTE4bj5TZWxlY3QgYSBkYXRlLi4uPC9zcGFuPlxuICAgIH0gQGVsc2Uge1xuICAgIDxzcGFuPnt7IGZyb21TZWxlY3RlZFZhbHVlQXNEYXRlIHwgZGF0ZUZvcm1hdDogdGhpcy5sb2NhbGUoKTogJ2RkIE1NTSB5eXl5JyB9fTwvc3Bhbj5cbiAgICBAaWYgKHJhbmdlKCkpIHtcbiAgICA8c3Bhbj4tPC9zcGFuPlxuICAgIDxzcGFuPnt7IHRvU2VsZWN0ZWRWYWx1ZUFzRGF0ZSB8IGRhdGVGb3JtYXQ6IHRoaXMubG9jYWxlKCk6ICdkZCBNTU0geXl5eScgfX08L3NwYW4+XG4gICAgfVxuICAgIH1cbiAgPC9zcGFuPlxuICA8c2xvdCBuYW1lPVwic3VwcG9ydGluZy10ZXh0XCIgc2xvdD1cInN1cHBvcnRpbmctdGV4dFwiPjwvc2xvdD5cbiAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cImNvbnRlbnRzXCIgLz5cbiAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cImFjdGlvbnNcIiAvPlxuPC9tZC1kaWFsb2c+XG59XG59Il19